# BNFeatureGenerator: Математическое обоснование

## Обзор

[`BNFeatureGenerator`](../../api/feature_extraction/feature_extraction.md) реализует новый подход к инжинирингу признаков с помощью байесовских сетей, как описано в статье ["Bayesian feature construction for the improvement of classification performance"](https://www.researchgate.net/publication/339293950_Bayesian_feature_construction_for_the_improvement_of_classification_performance) Манолиса Марагудакиса. Этот модуль автоматически создает вероятностные лямбда-признаки, полученные из вывода в байесовской сети, что позволяет моделировать сложные взаимосвязи и может улучшить производительность модели.

## Математическая основа

### Построение байесовской сети

Алгоритм состоит из нескольких ключевых шагов:

1. **Обучение структуре**: Обучается направленный ациклический граф (DAG) для представления вероятностных взаимосвязей между переменными.

2. **Обучение параметрам**: Модуль подбирает условные вероятностные распределения для каждого узла.

### Генерация признаков через вероятностный вывод

Процесс преобразования создает лямбда-признаки следующим образом:

1. Для каждого исходного признака $X_i$ генерируется соответствующий лямбда-признак $\lambda_i$.
2. Для дискретных признаков: $\lambda_i = P(X_i = x_i | Pa(X_i) = pa_i)$
3. Для непрерывных признаков: $\lambda_i = P(X_i \leq x_i | Pa(X_i) = pa_i)$

Эти лямбда-признаки фиксируют сложные вероятностные взаимосвязи, которые линейные модели не могут выразить, кодируя условную вероятность наблюдаемых значений при заданных родительских узлах.

## Пример

Следующий пример демонстрирует, как использовать BNFeatureGenerator на наборе данных аутентификации банкнот:

``` py title="examples/feature_extraction/banknote-authentication_example.py"
--8<-- "examples/feature_extraction/banknote_authentication_example.py"
```

BNFeatureGenerator повышает производительность модели, фиксируя сложные вероятностные взаимосвязи в данных, что улучшает способность классификатора различать классы, как показано в примере выше. 
