# NMIFeatureSelector: Отбор признаков с помощью нормализованной взаимной информации

## Обзор

Класс [`NMIFeatureSelector`](../../api/feature_selection/nmi_feature_selection.md) выполняет отбор признаков путем
оценки нормализованной взаимной информации (NMI) между признаками и целевой переменной на основе статьи [
`Local Bayesian Network Structure Learning for High-Dimensional Data`](https://ieeexplore.ieee.org/document/10589754).
Этот метод выявляет признаки с сильными статистическими зависимостями от цели, одновременно уменьшая избыточность среди
выбранных признаков. Он особенно эффективен для улавливания нелинейных взаимосвязей и совместим с
API `SelectorMixin` из scikit-learn.

---

## Математическая основа

### Нормализованная взаимная информация (NMI)

NMI измеряет зависимость между двумя переменными, нормализованную в диапазоне [0, 1]. Для признаков \(a\) и \(b\) NMI
вычисляется как:

\[ \text{NMI}(a, b) = \frac{H(a) + H(b) - H(a, b)}{\min(H(a), H(b))} \]

где:

- \(H(a)\) и \(H(b)\) — это энтропии \(a\) и \(b\),
- \(H(a, b)\) — их совместная энтропия.

Более высокие значения NMI указывают на более сильные зависимости.

## Дискретизация данных

Алгоритм дискретизирует признаки для эффективного вычисления энтропии:

- **Целочисленные/строковые столбцы**: сопоставляются с перечислимыми категориями.
- **Столбцы с плавающей точкой**: дискретизируются с использованием равномерной дискретизации с заданным количеством бинов.

---

## Процесс отбора признаков

1. **Первый этап**:
    - Вычислить NMI между каждым признаком и целью.
    - Выбрать признаки с NMI > `threshold`.

2. **Второй этап**:
    - Для каждой пары выбранных признаков вычислить попарное NMI.
    - Удалить признак \(f_j\), если:
        - Другой признак \(f_i\) имеет более высокое NMI с целью, и
        - NMI(\(f_i\), \(f_j\)) > NMI(\(f_j\), цель).

Это уменьшает избыточность, приоритизируя признаки, более релевантные для цели.

---

## Пример

``` py title="examples/feature_selection/nmi_fs_example.py"
--8<-- "examples/feature_selection/nmi_fs_example.py"
```
